<button id="generate-word">Generate Word</button>
<script>
  import PizZip from "pizzip";
  import Docxtemplater from "docxtemplater";
  import { saveAs } from "file-saver";

  const generateWordButton = document.getElementById("generate-word");
  generateWordButton!.addEventListener("click", function () {
    // Cargar el archivo de plantilla como un blob
    fetch("https://docxtemplater.com/ang-example.docx")
      .then((response) => response.arrayBuffer())
      .then((content) => {
        const zip = new PizZip(content);
        const doc = new Docxtemplater(zip, {
          paragraphLoop: true,
          linebreaks: true,
        });

        // Render the document (Replace {first_name} by John, {last_name} by Doe, ...)
        doc.render({
          first_name: "John",
          last_name: "Doe",
          phone: "0652455478",
          description: "New Website",
        });

        const blob = doc.getZip().generate({
          type: "blob",
          mimeType:
            "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
          // compression: DEFLATE adds a compression step.
          // For a 50MB output document, expect 500ms additional CPU time
          compression: "DEFLATE",
        });
        // Output the document using Data-URI
        saveAs(blob, "output.docx");
      })
      .catch((error) => {
        console.error("Error loading the template:", error);
      });
  });
</script>
